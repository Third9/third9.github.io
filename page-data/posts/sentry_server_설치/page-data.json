{"componentChunkName":"component---src-templates-post-template-js","path":"/posts/sentry_server_설치/","result":{"data":{"markdownRemark":{"id":"39f9fcb3-5e91-52d7-93e3-cf63829ff977","html":"<h1 id=\"sentry-서버-설치\" style=\"position:relative;\"><a href=\"#sentry-%EC%84%9C%EB%B2%84-%EC%84%A4%EC%B9%98\" aria-label=\"sentry 서버 설치 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Sentry 서버 설치</h1>\n<blockquote>\n<p>Sentry는 error-tracking과 log관리등의 이슈관리를 위한 모니터링 서비스다.</p>\n</blockquote>\n<ul>\n<li>Ubuntu:14.04</li>\n<li>python:2.7</li>\n<li>Sentry: 8.18.0</li>\n<li>postgreSQL: 9.4</li>\n<li>Redis: 3.2.9</li>\n</ul>\n<h2 id=\"설치-전-모듈-및-서버-설정\" style=\"position:relative;\"><a href=\"#%EC%84%A4%EC%B9%98-%EC%A0%84-%EB%AA%A8%EB%93%88-%EB%B0%8F-%EC%84%9C%EB%B2%84-%EC%84%A4%EC%A0%95\" aria-label=\"설치 전 모듈 및 서버 설정 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>설치 전 모듈 및 서버 설정</h2>\n<p>설치를 위한 기본 환경은 위와 같으며 sentry 설치 전 몇가지 setting을 해주어야 한다.</p>\n<ol>\n<li>\n<p>sentry 의 원할한 설치 및 구동을 위해서 sentry라는 명칭의 계정을 생성한다</p>\n<pre class=\"grvsc-container monokai\" data-language=\"ps\" data-index=\"0\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk3\"># 해당 명령어 실행 후 나오는 입력 내용을 순차적으로 입력한다.(Id, password, name 등등)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">$ adduser sentry</span></span></span></code></pre>\n</li>\n<li>\n<p>sentry 설치를 위한 모듈들 설치</p>\n<pre class=\"grvsc-container monokai\" data-language=\"ps\" data-index=\"1\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">$ sudo apt</span><span class=\"mtk7\">-</span><span class=\"mtk1\">get install </span><span class=\"mtk7\">-</span><span class=\"mtk1\">y python</span><span class=\"mtk7\">-</span><span class=\"mtk1\">pip \\</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">python</span><span class=\"mtk7\">-</span><span class=\"mtk1\">setuptools \\</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">python</span><span class=\"mtk7\">-</span><span class=\"mtk1\">dev \\</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">libxslt1</span><span class=\"mtk7\">-</span><span class=\"mtk1\">dev \\</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">gcc \\</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">libffi</span><span class=\"mtk7\">-</span><span class=\"mtk1\">dev \\</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">libjpeg</span><span class=\"mtk7\">-</span><span class=\"mtk1\">dev \\</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">libxml2</span><span class=\"mtk7\">-</span><span class=\"mtk1\">dev \\</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">libxslt</span><span class=\"mtk7\">-</span><span class=\"mtk1\">dev \\</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">libyaml</span><span class=\"mtk7\">-</span><span class=\"mtk1\">dev \\</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">libpq</span><span class=\"mtk7\">-</span><span class=\"mtk1\">dev</span></span></span></code></pre>\n</li>\n<li>위의 작업까지 마무리 하였다면 다음으로 worker의 역할과 issue 보관을 위한 redis와 postgresql을 설치해야 한다. worker의 역할은 rabbitMQ도 사용 가능하지만 여기서는 redis를 사용한다.</li>\n</ol>\n<h2 id=\"sentry-연동을-위한-postgre-sql-설치-및-셋팅\" style=\"position:relative;\"><a href=\"#sentry-%EC%97%B0%EB%8F%99%EC%9D%84-%EC%9C%84%ED%95%9C-postgre-sql-%EC%84%A4%EC%B9%98-%EB%B0%8F-%EC%85%8B%ED%8C%85\" aria-label=\"sentry 연동을 위한 postgre sql 설치 및 셋팅 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Sentry 연동을 위한 Postgre-SQL 설치 및 셋팅</h2>\n<blockquote>\n<p>PostgreSQL은 12.04, 14.04, 16.04 버전의 경우는 ubuntu의 apt repo를 통한 설치를 정상적으로 지원한다. 여기서는 <code>9.4</code> 버전의 설치를 다룬다.</p>\n<p>또한, 버전에 따라서 설치에 조금씩의 차이가 있는데 해당 방법은 <a href=\"https://www.postgresql.org/download/linux/ubuntu/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">링크</a>를 통해서 안내한다. 여기서는 14.04 버전을 기준으로 안내한다.</p>\n<p>Redis의 설치 방법은 여기선 다루지 않는다.</p>\n</blockquote>\n<h3 id=\"postgre-sql-설치\" style=\"position:relative;\"><a href=\"#postgre-sql-%EC%84%A4%EC%B9%98\" aria-label=\"postgre sql 설치 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>#Postgre-SQL 설치</h3>\n<pre class=\"grvsc-container monokai\" data-language=\"ps\" data-index=\"2\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk3\"># 우선 pgdg list를 만든다. (이미 존재하는 경우 파일 생성없이 내용만 추가)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">$ cd </span><span class=\"mtk7\">/</span><span class=\"mtk1\">etc</span><span class=\"mtk7\">/</span><span class=\"mtk1\">apt</span><span class=\"mtk7\">/</span><span class=\"mtk1\">sources.list.d</span><span class=\"mtk7\">/</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">$ touch pgdg.list</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk3\"># pgdg.list 파일 생성 후 해당 파일내에 아래의 내용을 추가 후 저장한다.</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">deb http:</span><span class=\"mtk7\">//</span><span class=\"mtk1\">apt.postgresql.org</span><span class=\"mtk7\">/</span><span class=\"mtk1\">pub</span><span class=\"mtk7\">/</span><span class=\"mtk1\">repos</span><span class=\"mtk7\">/</span><span class=\"mtk1\">apt</span><span class=\"mtk7\">/</span><span class=\"mtk1\"> trusty</span><span class=\"mtk7\">-</span><span class=\"mtk1\">pgdg main</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk3\"># 이후에 아래의 명령어를 수행한다.</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">$ wget </span><span class=\"mtk7\">--</span><span class=\"mtk1\">quiet </span><span class=\"mtk7\">-</span><span class=\"mtk1\">O </span><span class=\"mtk7\">-</span><span class=\"mtk1\"> https:</span><span class=\"mtk7\">//</span><span class=\"mtk1\">www.postgresql.org</span><span class=\"mtk7\">/</span><span class=\"mtk1\">media</span><span class=\"mtk7\">/</span><span class=\"mtk1\">keys</span><span class=\"mtk7\">/</span><span class=\"mtk1\">ACCC4CF8.asc </span><span class=\"mtk7\">|</span><span class=\"mtk1\"> \\</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">\tsudo apt</span><span class=\"mtk7\">-</span><span class=\"mtk1\">key add </span><span class=\"mtk7\">-</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">$ sudo apt</span><span class=\"mtk7\">-</span><span class=\"mtk1\">get update</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk3\"># 위의 작업까지 완료하였다면 아래의 명령어로 postgresql을 설치한다.</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">$ apt</span><span class=\"mtk7\">-</span><span class=\"mtk1\">get install postgresql</span><span class=\"mtk7\">-</span><span class=\"mtk4\">9.4</span></span></span></code></pre>\n<h3 id=\"postgre-sql-셋팅\" style=\"position:relative;\"><a href=\"#postgre-sql-%EC%85%8B%ED%8C%85\" aria-label=\"postgre sql 셋팅 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>#Postgre-SQL 셋팅</h3>\n<blockquote>\n<p>PostgreSQL 명령어 <a href=\"https://www.postgresql.org/docs/current/static/sql-commands.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">링크</a></p>\n</blockquote>\n<pre class=\"grvsc-container monokai\" data-language=\"ps\" data-index=\"3\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk3\"># postgresql 관리자 계정이 정상적으로 생성되어 있는지를 확인한다.</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">$ cat </span><span class=\"mtk7\">/</span><span class=\"mtk1\">etc</span><span class=\"mtk7\">/</span><span class=\"mtk1\">password </span><span class=\"mtk7\">|</span><span class=\"mtk1\"> grep </span><span class=\"mtk6\">&#39;postgres&#39;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk3\"># PostgreSQL 작동여부 체크</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">$ </span><span class=\"mtk7\">/</span><span class=\"mtk1\">etc</span><span class=\"mtk7\">/</span><span class=\"mtk1\">init.d</span><span class=\"mtk7\">/</span><span class=\"mtk1\">postgresql status</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk3\"># 작동중이지 않다면 start 명령을 이용하여 작동시켜준다.(이미 동작중이면 실행하지 않아도 된다.)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">$ </span><span class=\"mtk7\">/</span><span class=\"mtk1\">etc</span><span class=\"mtk7\">/</span><span class=\"mtk1\">init.d</span><span class=\"mtk7\">/</span><span class=\"mtk1\">postgresql start</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk3\">## 관리자 계정의 password 변경 및 sentry 계정 생성을 위해서 psql에 접근</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk3\"># 관리자 계정 postgres로 접근</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">$ sudo </span><span class=\"mtk7\">-</span><span class=\"mtk1\">u postgres psql template1</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk3\"># password 변경</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">template1</span><span class=\"mtk7\">=</span><span class=\"mtk3\"># ALTER USER postgres with encrypted password &#39;패스워드&#39;;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk3\"># sentry 계정 추가 및 LOGIN 권한 부여 (Password는 위에서 postgres 계정에 부여 하듯이 하면 된다.)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">template1</span><span class=\"mtk7\">=</span><span class=\"mtk3\"># CREATE ROLE sentry WITH LOGIN;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk3\"># 계정 추가 후 해당 계정에 권한을 추가한다. (sentry 실행시 관련 db등을 생성하기에 sentry 계정 사용시 권한이 있어야 한다.)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">template1</span><span class=\"mtk7\">=</span><span class=\"mtk3\"># ALTER ROLE sentry WITH CREATEDB CREATEROLE;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk3\"># 데이터 베이스 권한 부여</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">template1</span><span class=\"mtk7\">=</span><span class=\"mtk3\"># GRANT ALL ON DATABASE databasename TO username;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk3\"># 작업을 모두 마치면 정상적으로 접근 가능한지 Test., 두개의 계정모두 접속 가능한지 test 한다.</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">$ psql </span><span class=\"mtk7\">-</span><span class=\"mtk1\">h </span><span class=\"mtk4\">127.0</span><span class=\"mtk1\">.</span><span class=\"mtk4\">0.1</span><span class=\"mtk1\"> </span><span class=\"mtk7\">-</span><span class=\"mtk1\">U postgres template1</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">$ psql </span><span class=\"mtk7\">-</span><span class=\"mtk1\">h </span><span class=\"mtk4\">127.0</span><span class=\"mtk1\">.</span><span class=\"mtk4\">0.1</span><span class=\"mtk1\"> </span><span class=\"mtk7\">-</span><span class=\"mtk1\">U sentry template1</span></span></span></code></pre>\n<h3 id=\"sentry-설치\" style=\"position:relative;\"><a href=\"#sentry-%EC%84%A4%EC%B9%98\" aria-label=\"sentry 설치 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>#Sentry 설치</h3>\n<h4 id=\"1-python-환경설정-및-sentry-설치\" style=\"position:relative;\"><a href=\"#1-python-%ED%99%98%EA%B2%BD%EC%84%A4%EC%A0%95-%EB%B0%8F-sentry-%EC%84%A4%EC%B9%98\" aria-label=\"1 python 환경설정 및 sentry 설치 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>1. python 환경설정 및 sentry 설치</h4>\n<p>sentry는 Django기반의 서비스이므로 virtualenv를 이용해서 환경 설정을 한 뒤 진행하는 것을 추천한다.</p>\n<pre class=\"grvsc-container monokai\" data-language=\"ps\" data-index=\"4\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk3\"># virtualenv install</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">$ pip install </span><span class=\"mtk7\">-</span><span class=\"mtk1\">U virtualenv</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk3\"># virtualenv setting</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">$ virtualenv ~</span><span class=\"mtk7\">/</span><span class=\"mtk1\">.venv</span><span class=\"mtk7\">/</span><span class=\"mtk1\">sentry</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk3\"># virtualenv activate</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">$ </span><span class=\"mtk7\">.</span><span class=\"mtk1\"> ~</span><span class=\"mtk7\">/</span><span class=\"mtk1\">.venv</span><span class=\"mtk7\">/</span><span class=\"mtk1\">sentry</span><span class=\"mtk7\">/</span><span class=\"mtk1\">bin</span><span class=\"mtk7\">/</span><span class=\"mtk1\">activate</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk3\"># sentry 설치</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">$ pip install </span><span class=\"mtk7\">-</span><span class=\"mtk1\">U sentry</span><span class=\"mtk7\">==</span><span class=\"mtk4\">8.18</span><span class=\"mtk1\">.</span><span class=\"mtk4\">0</span></span></span></code></pre>\n<p>위의 작업까지 성공적으로 이어졌다면 sentry 서버 구동을 위한 설정 및 실행을 하면 된다. 하지만 정상적으로 구동하지 않고 에러가 출력되면 그에 대응하는 작업을 수행해야 한다. 에러 메시지는 사용자의 상황마다 다르므로 여기서는 2개 정도의 에러에 대해서만 간략히 설명한다.</p>\n<blockquote>\n<p>E1: ValueError: jpeg is required unless explicitly disabled using —disable-jpeg, aborting</p>\n<pre class=\"grvsc-container monokai\" data-language=\"ps\" data-index=\"5\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk3\"># 아래의 모듈 설치</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">$ sudo apt</span><span class=\"mtk7\">-</span><span class=\"mtk1\">get install libjpeg</span><span class=\"mtk7\">-</span><span class=\"mtk1\">dev zlib1g</span><span class=\"mtk7\">-</span><span class=\"mtk1\">dev</span></span></span></code></pre>\n</blockquote>\n<blockquote>\n<p>E2: error: command ‘x86_64-linux-gnu-gcc’ failed with exit status 1</p>\n<pre class=\"grvsc-container monokai\" data-language=\"ps\" data-index=\"6\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk3\"># 아래의 모듈 설치</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">$ sudo apt</span><span class=\"mtk7\">-</span><span class=\"mtk1\">get install libssl</span><span class=\"mtk7\">-</span><span class=\"mtk1\">dev libffi</span><span class=\"mtk7\">-</span><span class=\"mtk1\">dev</span></span></span></code></pre>\n</blockquote>\n<h4 id=\"2-sentry-초기-환경설정\" style=\"position:relative;\"><a href=\"#2-sentry-%EC%B4%88%EA%B8%B0-%ED%99%98%EA%B2%BD%EC%84%A4%EC%A0%95\" aria-label=\"2 sentry 초기 환경설정 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>2. Sentry 초기 환경설정</h4>\n<p>위의 작업까지 진행하여 설치를 완료하였다면 sentry 설정을 진행한다.</p>\n<pre class=\"grvsc-container monokai\" data-language=\"ps\" data-index=\"7\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk3\"># init 파일 생성(기본 생성 위치는 &#39;~/.sentry&#39; 이다)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">$ sentry init {경로 위치}</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">ex) sentry init or sentry init </span><span class=\"mtk7\">/</span><span class=\"mtk1\">etc</span><span class=\"mtk7\">/</span><span class=\"mtk1\">sentry</span></span></span></code></pre>\n<p>위의 명령어 실행 후 해당 위치에 생성된 sentry.conf.py 파일을 수정</p>\n<pre class=\"grvsc-container monokai\" data-language=\"python\" data-index=\"8\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk3\"># ~/.sentry/sentry.conf.py</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk3\"># for more information on DATABASES, see the Django configuration at:</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk3\"># https://docs.djangoproject.com/en/1.6/ref/databases/</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk4\">DATABASES</span><span class=\"mtk1\"> </span><span class=\"mtk7\">=</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk6\">&#39;default&#39;</span><span class=\"mtk1\">: {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk6\">&#39;ENGINE&#39;</span><span class=\"mtk1\">: </span><span class=\"mtk6\">&#39;sentry.db.postgres&#39;</span><span class=\"mtk1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk6\">&#39;NAME&#39;</span><span class=\"mtk1\">: </span><span class=\"mtk6\">&#39;sentry&#39;</span><span class=\"mtk1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk6\">&#39;USER&#39;</span><span class=\"mtk1\">: </span><span class=\"mtk6\">&#39;sentry&#39;</span><span class=\"mtk1\">, </span><span class=\"mtk3\"># postgresql에 등록한 계정으로 입력</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk6\">&#39;PASSWORD&#39;</span><span class=\"mtk1\">: </span><span class=\"mtk6\">&#39;postgresql 계정 password&#39;</span><span class=\"mtk1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk6\">&#39;HOST&#39;</span><span class=\"mtk1\">: </span><span class=\"mtk6\">&#39;&#39;</span><span class=\"mtk1\">, </span><span class=\"mtk3\"># local인 경우 127.0.0.1</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk6\">&#39;PORT&#39;</span><span class=\"mtk1\">: </span><span class=\"mtk6\">&#39;&#39;</span><span class=\"mtk1\">, </span><span class=\"mtk3\"># postgresql의 port</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">}</span></span></span></code></pre>\n<blockquote>\n<p>Redis의 경우 기본 설정을 그대로 사용한다면 별도로 수정할 부분은 없다., mail발송을 위한 설정을 할 수 있지만 여기서는 다루지 않는다(메일서버는 sendmail을 이용하는 것이 일반적이다)</p>\n</blockquote>\n<p>모든 설정을 마무리 하였으면 순차적으로 명령어를 실행하여 migration 작업을 수행한다.</p>\n<pre class=\"grvsc-container monokai\" data-language=\"ps\" data-index=\"9\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk3\"># sentry migration</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk3\"># DB 생성에 있어서 여기서는 sentry 라는 명칭을 사용한다.</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">$ createdb </span><span class=\"mtk7\">-</span><span class=\"mtk1\">E utf</span><span class=\"mtk7\">-</span><span class=\"mtk4\">8</span><span class=\"mtk1\"> sentry</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk3\"># 아래의 명령을 수행하면 postgresql/redis에 sentry 관련 데이터를 생성하며, sentry 계정을 만들수 있다.</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk3\"># 이때에 superuser를 만들지 여부를 물어보는데 여기서 만들어야지 이후에 다시 만드는 작업을 하지 않아도 된다.</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">$ sentry upgrade</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk3\"># 추가로 user를 만들생각이면 아래의 명령어로 만들어 주어도 된다.</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">$ sentry createuser</span></span></span></code></pre>\n<h4 id=\"3-sentry-서버-실행\" style=\"position:relative;\"><a href=\"#3-sentry-%EC%84%9C%EB%B2%84-%EC%8B%A4%ED%96%89\" aria-label=\"3 sentry 서버 실행 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>3. Sentry 서버 실행</h4>\n<p>위의 작업을 모두 완료하였다면 sentry 사용을 위한 서비스들을 실행시킨다. sentry는 데이터 수집 및 스케쥴링, 그리고 Web 서비스를 위한 worker, cron, web 3개의 서비스로 구성되어있다.</p>\n<pre class=\"grvsc-container monokai\" data-language=\"ps\" data-index=\"10\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk3\">## 아래의 3가지 서비스를 실행시켜야 정상적인 수행이 가능하다.</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk3\"># sentry의 worker</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">$ sentry run worker</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk3\"># sentry의 cron process</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">$ sentry run cron</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk3\"># sentry의 web 서버., web 서비스의 경우 가장 마지막에 수행하는 것이 좋다</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">$ sentry run web</span></span></span></code></pre>\n<h4 id=\"4-daemon-실행\" style=\"position:relative;\"><a href=\"#4-daemon-%EC%8B%A4%ED%96%89\" aria-label=\"4 daemon 실행 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>4. Daemon 실행</h4>\n<p>위의 단계를 모두 진행하였으면 sentry 서버를 실행하고 사용하는데는 문제가 없지만, daemon 형태로 서비스를 수행하기 위해서는 systemd, upstart와 같은 프로그램을 이용해서 안정적으로 사용이 가능하다.</p>\n<blockquote>\n<p>추가적으로 ubuntu 15부터 systemd를 지원하며, LTS 버전으로 한정할 경우 16버전부터 지원을 한다.</p>\n<p>문서에서 설명한 ubuntu 14에서는 upstart를 사용하므로 upstart 스크립트 작성 및 사용법을 기술한다.</p>\n<p>systemd를 이용하여 서비스하는 방법은 <a href=\"https://docs.sentry.io/server/installation/python/#running-sentry-as-a-service\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">링크</a> 참조.</p>\n</blockquote>\n<p>upstart를 이용하여 daemon을 구동할 경우, 시스템 부팅시의 자동 실행 및 서비스 종료시 자동 재시작 로그파일 기록 등등의 장점이 있다. 우선은 아래의 script를 작성하여야 한다. (예시에서는 web만을 작성하였지만 실제로는 worker, cron 등에 대한 script도 만들어야 한다.)</p>\n<pre class=\"grvsc-container monokai\" data-language=\"ps\" data-index=\"11\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk3\"># upstart에서 수행되는 서비스들의 script는 /etc/init/ 경로에 ***.conf 파일의 형태로 작성해줘야 한다.</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">$ cd </span><span class=\"mtk7\">/</span><span class=\"mtk1\">etc</span><span class=\"mtk7\">/</span><span class=\"mtk1\">init</span><span class=\"mtk7\">/</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">$ touch sentry</span><span class=\"mtk7\">-</span><span class=\"mtk1\">web.conf</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk3\"># 위에서 생성한 sentry-web.conf 파일을 열어서 script 내용을 등록한다.</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">$ vim sentry</span><span class=\"mtk7\">-</span><span class=\"mtk1\">web.conf</span></span></span></code></pre>\n<p>위의 작업까지 수행하였다면 아래의 코드를 위에서 만들어둔 <code>sentry-web.conf</code> 파일에 작성한다.</p>\n<pre class=\"grvsc-container monokai\" data-language=\"conf\" data-index=\"12\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk3\"># /etc/init/sentry-web.conf</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">start on runlevel [2346]</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">stop on runlevel [016]</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk3\"># 서비스가 오류로 종료시에 자동 재시작</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk3\"># (단, 너무 빨리 재시작 되는것에 대한 제한을 수정. 5초 동안 4번 재시작 되면 재시작 하지 않음)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">respawn limit 4 5</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">env </span><span class=\"mtk7\">USER</span><span class=\"mtk1\">=www-data</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">env </span><span class=\"mtk7\">PATH</span><span class=\"mtk1\">=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">env </span><span class=\"mtk7\">PWD</span><span class=\"mtk1\">=/usr/local/lib/python2.7/dist-packages</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk3\"># script가 수행되기 전 해당 서비스의 log 생성 및 권한 부여</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">pre-start script</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  if [ ! -f /var/log/sentry-web.log ]</span><span class=\"mtk3\">; then</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    touch /var/log/sentry-web.log</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    chown -f $USER /var/log/sentry-web.log</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  fi</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">end script</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk3\"># 서비스 수행을 위한 main script</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">script</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">. /home/sentry/activate  </span><span class=\"mtk3\"># venv 실행</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">start-stop-daemon --start \\  </span><span class=\"mtk3\"># daemon으로 수행</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  --make-pidfile --pidfile /var/run/sentry-web.pid \\ </span><span class=\"mtk3\"># proccess id 파일</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  --chuid $USER \\</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  --chdir $PWD \\</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  --exec /home/sentry/.venv/sentry/local/bin/sentry\\</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        --</span><span class=\"mtk7\">config</span><span class=\"mtk1\">=/home/sentry/.sentry/\\ </span><span class=\"mtk3\"># sentry 수행을 위한 환경설정파일</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        run web &gt;&gt; /var/log/sentry-web.log 2&gt;&amp;1 </span><span class=\"mtk3\"># web 서비스 수행 및 log stdout/stderr 로그 등록</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">end script</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk3\"># 서비스 종료시에 process id 삭제</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">post-stop script</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  if [ -f /var/run/sentry-web.pid ]</span><span class=\"mtk3\">; then</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    rm /var/run/sentry-web.pid</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  fi</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">end script</span></span></span></code></pre>\n<p>위와 같이 작성 완료 후 <code>sudo start sentry-web</code> 명령어를 실행하면 web이 daemon 으로 수행된다. worker, cron도 위와 같이 script를 작성한 뒤에 실행시켜주면 해당 서비스를 수행할 수 있다.</p>\n<blockquote>\n<p>나머지 worker, cron에 관련한 script</p>\n</blockquote>\n<pre class=\"grvsc-container monokai\" data-language=\"conf\" data-index=\"13\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk3\"># /etc/init/sentry-worker.conf</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">start on runlevel [2345]</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">stop on runlevel [016]</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">respawn limit 4 5</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">env </span><span class=\"mtk7\">USER</span><span class=\"mtk1\">=www-data</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">env </span><span class=\"mtk7\">PATH</span><span class=\"mtk1\">=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">env </span><span class=\"mtk7\">PWD</span><span class=\"mtk1\">=/usr/local/lib/python2.7/dist-packages</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">pre-start script</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  if [ ! -f /var/log/sentry-web.log ]</span><span class=\"mtk3\">; then</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    touch /var/log/sentry-worker.log</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    chown -f $USER /var/log/sentry-worker.log</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  fi</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">end script</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">script</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">. /home/sentry/activate</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">start-stop-daemon --start \\</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  --make-pidfile --pidfile /var/run/sentry-worker.pid \\</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  --chuid $USER \\</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  --chdir $PWD \\</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  --exec /home/sentry/.venv/sentry/local/bin/sentry\\</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        -- --</span><span class=\"mtk7\">config</span><span class=\"mtk1\">=/home/sentry/.sentry/\\</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        run worker &gt;&gt; /var/log/sentry-worker.log 2&gt;&amp;1</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">end script</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">post-stop script</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  if [ -f /var/run/sentry-worker.pid ]</span><span class=\"mtk3\">; then</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    rm /var/run/sentry-worker.pid</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  fi</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">end script</span></span></span></code></pre>\n<pre class=\"grvsc-container monokai\" data-language=\"conf\" data-index=\"14\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk3\"># /etc/init/sentry-cron.conf</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">start on runlevel [2345]</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">stop on runlevel [016]</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">respawn limit 4 5</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">env </span><span class=\"mtk7\">USER</span><span class=\"mtk1\">=www-data</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">env </span><span class=\"mtk7\">PATH</span><span class=\"mtk1\">=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">env </span><span class=\"mtk7\">PWD</span><span class=\"mtk1\">=/usr/local/lib/python2.7/dist-packages</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">pre-start script</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  if [ ! -f /var/log/sentry-cron.log ]</span><span class=\"mtk3\">; then</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    touch /var/log/sentry-cron.log</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    chown -f $USER /var/log/sentry-cron.log</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  fi</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">end script</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">script</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">. /home/sentry/activate</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">start-stop-daemon --start \\</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  --make-pidfile --pidfile /var/run/sentry-cron.pid \\</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  --chuid $USER \\</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  --chdir $PWD \\</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  --exec /home/sentry/.venv/sentry/local/bin/sentry\\</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        -- --</span><span class=\"mtk7\">config</span><span class=\"mtk1\">=/home/sentry/.sentry/\\</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        run cron &gt;&gt; /var/log/sentry-cron.log 2&gt;&amp;1</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">end script</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">post-stop script</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  if [ -f /var/run/sentry-cron.pid ]</span><span class=\"mtk3\">; then</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    rm /var/run/sentry-cron.pid</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  fi</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">end script</span></span></span></code></pre>\n<blockquote>\n<p>이전 버전의 경우 환경설정의 경로를 <code>{your path}/sentry/sentry.conf.py</code> 로 표기하는 경우가 있는데 그럴경우 secret-key 가 없어서 새로 생성하라는 메시지가 뜨는 경우가 있다. 실제로 secret-key가 없는 경우일수도 있지만, 경로가 잘못되어서 발생하는 문제일 수 있다. 최신버전의 sentry는 config.yaml 파일에 secret-key가 존재하기에 최신버전의 경우 환경설정파일 경로를 <code>{your path}/sentry/</code> 로 지정해주어야 한다.</p>\n</blockquote>\n<h2 id=\"sentry-upgrade-by-2020-09-13-내용수정\" style=\"position:relative;\"><a href=\"#sentry-upgrade-by-2020-09-13-%EB%82%B4%EC%9A%A9%EC%88%98%EC%A0%95\" aria-label=\"sentry upgrade by 2020 09 13 내용수정 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Sentry Upgrade by 2020-09-13 내용수정</h2>\n<blockquote>\n<p>Sentry 8.18.0 => 9.1.2</p>\n</blockquote>\n<ol>\n<li>sentry가 설치된 서버에 ssh로 접근을 하여야 한다.</li>\n<li>해당 서버에 접근하여 sentry가 설치된 python 환경을 activate 시켜준다.</li>\n<li>\n<p>activate된 환경에서 기존에 설치된 sentry의 버전을 upgrdate 해준다.</p>\n<blockquote>\n<p>여기서는 9.1.2 버전의 upgrade에 대한 내용을 다룬다. 9.1.2 이상부터는 Sentry가 docker-compose를 이용한 환경을 지원하기에 그 이상의 버전으로는 가능하다면 docker-compose를 활용한 설치를 추천한다.</p>\n</blockquote>\n<pre class=\"grvsc-container monokai\" data-language=\"ps\" data-index=\"15\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">$ pip install </span><span class=\"mtk7\">-</span><span class=\"mtk1\">U sentry</span><span class=\"mtk7\">==</span><span class=\"mtk4\">9.1</span><span class=\"mtk1\">.</span><span class=\"mtk4\">2</span></span></span></code></pre>\n</li>\n<li>설치가 완료되었다면, 설정 파일을 새로 만들어준다., <code>단, 무조건 꼭 만들어야 하는건 아니다</code> 필자도 새로 만들지 않고 진행을 하였다. 하지만 문서에서는 major update인 경우에는 설정 파일을 새로 만드는 것을 추천한다고 쓰여 있다.</li>\n<li>\n<p>위의 작업까지 완료하였다면, sentry cli를 활용하여, upgrade 명령을 수행한다. Sentry는 django를 기반으로 만들어졌기에 해당 upgrade작업시에 DB 모델의 migration 등의 작업을 같이 해주는 걸로 알고 있다.</p>\n<blockquote>\n</blockquote>\n<pre class=\"grvsc-container monokai\" data-language=\"ps\" data-index=\"16\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">$ sentry upgrade</span></span></span></code></pre>\n</li>\n<li>sentry upgrade작업까지 완료되었다면 sentry의 모든 서비스들(web, worker, cron)을 새로 restart 해줘야 한다. 이후에 페이지에 접속하여 version을 확인하면 9.1.2로 upgrade된 것을 확인 할 수 있다.</li>\n</ol>\n<h2 id=\"메일-발송-기능-추가-by-2020-09-13-내용수정\" style=\"position:relative;\"><a href=\"#%EB%A9%94%EC%9D%BC-%EB%B0%9C%EC%86%A1-%EA%B8%B0%EB%8A%A5-%EC%B6%94%EA%B0%80-by-2020-09-13-%EB%82%B4%EC%9A%A9%EC%88%98%EC%A0%95\" aria-label=\"메일 발송 기능 추가 by 2020 09 13 내용수정 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>메일 발송 기능 추가 by 2020-09-13 내용수정</h2>\n<p>우선 메일 발송을 위해서는 메일 서버를 설치하여야 한다.</p>\n<pre class=\"grvsc-container monokai\" data-language=\"ps\" data-index=\"17\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">$ sudo apt</span><span class=\"mtk7\">-</span><span class=\"mtk1\">get install </span><span class=\"mtk7\">-</span><span class=\"mtk1\">y sendmail &amp;&amp; sudo sendmailconfig</span></span></span></code></pre>\n<p>메일 서버 설치 후 아래와 같이 설정파일을 수정한다.</p>\n<pre class=\"grvsc-container monokai\" data-language=\"yaml\" data-index=\"18\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk3\"># config.yaml</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk3\">###############</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk3\"># Mail Server #</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk3\">###############</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk7\">mail.backend</span><span class=\"mtk1\">: </span><span class=\"mtk6\">&quot;smtp&quot;</span><span class=\"mtk1\"> </span><span class=\"mtk3\"># Use dummy if you want to disable email entirely</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk7\">mail.host</span><span class=\"mtk1\">: </span><span class=\"mtk6\">&quot;test.net&quot;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk7\">mail.port</span><span class=\"mtk1\">: </span><span class=\"mtk4\">25</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk7\">mail.username</span><span class=\"mtk1\">: </span><span class=\"mtk6\">&quot;&quot;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk7\">mail.password</span><span class=\"mtk1\">: </span><span class=\"mtk6\">&quot;&quot;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk7\">mail.use-tls</span><span class=\"mtk1\">: </span><span class=\"mtk4\">false</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk3\"># The email address to send on behalf of</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk7\">mail.from</span><span class=\"mtk1\">: </span><span class=\"mtk6\">&quot;sentry@test.net&quot;</span></span></span></code></pre>\n<pre class=\"grvsc-container monokai\" data-language=\"py\" data-index=\"19\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk3\"># sentry.conf.py</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk4\">ENV_CONFIG_MAPPING</span><span class=\"mtk1\"> </span><span class=\"mtk7\">=</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk6\">&#39;SENTRY_EMAIL_PASSWORD&#39;</span><span class=\"mtk1\">: </span><span class=\"mtk6\">&#39;mail.password&#39;</span><span class=\"mtk1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk6\">&#39;SENTRY_EMAIL_USER&#39;</span><span class=\"mtk1\">: </span><span class=\"mtk6\">&#39;mail.username&#39;</span><span class=\"mtk1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk6\">&#39;SENTRY_EMAIL_PORT&#39;</span><span class=\"mtk1\">: (</span><span class=\"mtk6\">&#39;mail.port&#39;</span><span class=\"mtk1\">, Int),</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk6\">&#39;SENTRY_EMAIL_USE_TLS&#39;</span><span class=\"mtk1\">: (</span><span class=\"mtk6\">&#39;mail.use-tls&#39;</span><span class=\"mtk1\">, Bool),</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk6\">&#39;SENTRY_EMAIL_HOST&#39;</span><span class=\"mtk1\">: </span><span class=\"mtk6\">&#39;mail.host&#39;</span><span class=\"mtk1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk6\">&#39;SENTRY_SERVER_EMAIL&#39;</span><span class=\"mtk1\">: </span><span class=\"mtk6\">&#39;mail.from&#39;</span><span class=\"mtk1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk6\">&#39;SENTRY_ENABLE_EMAIL_REPLIES&#39;</span><span class=\"mtk1\">: (</span><span class=\"mtk6\">&#39;mail.enable-replies&#39;</span><span class=\"mtk1\">, Bool),</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk6\">&#39;SENTRY_EMAIL_LIST_NAMESPACE&#39;</span><span class=\"mtk1\">: </span><span class=\"mtk6\">&#39;mail.list-namespace&#39;</span><span class=\"mtk1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk6\">&#39;SENTRY_SMTP_HOSTNAME&#39;</span><span class=\"mtk1\">: </span><span class=\"mtk6\">&#39;reply.getsentry.com&#39;</span><span class=\"mtk1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk6\">&#39;SENTRY_SECRET_KEY&#39;</span><span class=\"mtk1\">: </span><span class=\"mtk6\">&#39;system.secret-key&#39;</span><span class=\"mtk1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk6\">&#39;SENTRY_SMTP_HOST&#39;</span><span class=\"mtk1\">: </span><span class=\"mtk6\">&#39;0.0.0.0&#39;</span><span class=\"mtk1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk6\">&#39;SENTRY_SMTP_PORT&#39;</span><span class=\"mtk1\">: </span><span class=\"mtk4\">1025</span><span class=\"mtk1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk3\"># If you&#39;re using mailgun for inbound mail, set your API key and configure a</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk3\"># route to forward to /api/hooks/mailgun/inbound/</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">  </span><span class=\"mtk6\">&#39;SENTRY_MAILGUN_API_KEY&#39;</span><span class=\"mtk1\">: </span><span class=\"mtk6\">&#39;mail.mailgun-api-key&#39;</span><span class=\"mtk1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">}</span></span></span></code></pre>\n<p>다만, 본인의 경우 위의 방식처럼 tls옵션을 꺼도 계속 true로 표시가 되고, domain 주소가 바뀌지 않아서 직접 module 코드를 수정해 주었다.</p>\n<pre class=\"grvsc-container monokai\" data-language=\"py\" data-index=\"20\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk3\"># 설치된 sentry 모듈에서 위의 파일경로를 찾아가서 직접 수정</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk4\">...</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk9 mtki\">def</span><span class=\"mtk1\"> </span><span class=\"mtk5\">get_connection</span><span class=\"mtk1\">(</span><span class=\"mtk10 mtki\">fail_silently</span><span class=\"mtk7\">=</span><span class=\"mtk4\">False</span><span class=\"mtk1\">):</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk6\">&quot;&quot;&quot;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk6\">    Gets an SMTP connection using our OptionsStore</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk6\">    &quot;&quot;&quot;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk7\">return</span><span class=\"mtk1\"> _get_connection(</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk10 mtki\">backend</span><span class=\"mtk7\">=</span><span class=\"mtk1\">get_mail_backend(),</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk3\"># host=options.get(&#39;mail.host&#39;),</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk3\"># port=options.get(&#39;mail.port&#39;),</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk10 mtki\">host</span><span class=\"mtk7\">=</span><span class=\"mtk6\">&#39;localhost&#39;</span><span class=\"mtk1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk10 mtki\">port</span><span class=\"mtk7\">=</span><span class=\"mtk4\">25</span><span class=\"mtk1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk10 mtki\">username</span><span class=\"mtk7\">=</span><span class=\"mtk1\">options.get(</span><span class=\"mtk6\">&#39;mail.username&#39;</span><span class=\"mtk1\">),</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk10 mtki\">password</span><span class=\"mtk7\">=</span><span class=\"mtk1\">options.get(</span><span class=\"mtk6\">&#39;mail.password&#39;</span><span class=\"mtk1\">),</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk3\"># use_tls=options.get(&#39;mail.use-tls&#39;),</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk10 mtki\">use_tls</span><span class=\"mtk7\">=</span><span class=\"mtk4\">False</span><span class=\"mtk1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk10 mtki\">timeout</span><span class=\"mtk7\">=</span><span class=\"mtk1\">options.get(</span><span class=\"mtk6\">&#39;mail.timeout&#39;</span><span class=\"mtk1\">),</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        </span><span class=\"mtk10 mtki\">fail_silently</span><span class=\"mtk7\">=</span><span class=\"mtk1\">fail_silently,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    )</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk4\">...</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk4\">...</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk9 mtki\">def</span><span class=\"mtk1\"> </span><span class=\"mtk5\">send_messages</span><span class=\"mtk1\">(</span><span class=\"mtk10 mtki\">messages</span><span class=\"mtk1\">, </span><span class=\"mtk10 mtki\">fail_silently</span><span class=\"mtk7\">=</span><span class=\"mtk4\">False</span><span class=\"mtk1\">):</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    connection </span><span class=\"mtk7\">=</span><span class=\"mtk1\"> get_connection(</span><span class=\"mtk10 mtki\">fail_silently</span><span class=\"mtk7\">=</span><span class=\"mtk1\">fail_silently)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk3\"># 아래의 로직은 from_email 주소를 특정 domain으로 수정하기 위한 작업</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk7\">for</span><span class=\"mtk1\"> message </span><span class=\"mtk7\">in</span><span class=\"mtk1\"> messages:</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">      message.from_email </span><span class=\"mtk7\">=</span><span class=\"mtk1\"> </span><span class=\"mtk6\">&#39;sentry@test.net&#39;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    sent </span><span class=\"mtk7\">=</span><span class=\"mtk1\"> connection.send_messages(messages)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    metrics.incr(</span><span class=\"mtk6\">&#39;email.sent&#39;</span><span class=\"mtk1\">, </span><span class=\"mtk9\">len</span><span class=\"mtk1\">(messages), </span><span class=\"mtk10 mtki\">skip_internal</span><span class=\"mtk7\">=</span><span class=\"mtk4\">False</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk7\">for</span><span class=\"mtk1\"> message </span><span class=\"mtk7\">in</span><span class=\"mtk1\"> messages:</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        extra </span><span class=\"mtk7\">=</span><span class=\"mtk1\"> {</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            </span><span class=\"mtk6\">&#39;message_id&#39;</span><span class=\"mtk1\">: message.extra_headers[</span><span class=\"mtk6\">&#39;Message-Id&#39;</span><span class=\"mtk1\">],</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">            </span><span class=\"mtk6\">&#39;size&#39;</span><span class=\"mtk1\">: </span><span class=\"mtk9\">len</span><span class=\"mtk1\">(message.message().as_bytes()),</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        }</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">        logger.info(</span><span class=\"mtk6\">&#39;mail.sent&#39;</span><span class=\"mtk1\">, </span><span class=\"mtk10 mtki\">extra</span><span class=\"mtk7\">=</span><span class=\"mtk1\">extra)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">    </span><span class=\"mtk7\">return</span><span class=\"mtk1\"> sent</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk4\">...</span></span></span></code></pre>\n<h2 id=\"ubuntu-16-이상-버전의-systemd를-이용한-deamon-실행-by-2020-09-13-내용추가\" style=\"position:relative;\"><a href=\"#ubuntu-16-%EC%9D%B4%EC%83%81-%EB%B2%84%EC%A0%84%EC%9D%98-systemd%EB%A5%BC-%EC%9D%B4%EC%9A%A9%ED%95%9C-deamon-%EC%8B%A4%ED%96%89-by-2020-09-13-%EB%82%B4%EC%9A%A9%EC%B6%94%EA%B0%80\" aria-label=\"ubuntu 16 이상 버전의 systemd를 이용한 deamon 실행 by 2020 09 13 내용추가 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Ubuntu 16 이상 버전의 systemd를 이용한 deamon 실행 by 2020-09-13 내용추가</h2>\n<p><code>etc/systemd/system/</code> 경로에 service 수행을 위한 파일을 생성한다. 필자는 아래와 같은 명칭으로 생성하였다.(<code>sentry-web.service</code>, <code>sentry-cron.service</code>, <code>sentry-worker.service</code>)</p>\n<pre class=\"grvsc-container monokai\" data-language=\"ps\" data-index=\"21\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk3\"># sentry-web.service</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">[</span><span class=\"mtk9 mtki\">Unit</span><span class=\"mtk1\">]</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">Description</span><span class=\"mtk7\">=</span><span class=\"mtk1\">Sentry Main Service</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">After</span><span class=\"mtk7\">=</span><span class=\"mtk1\">network.target</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">Requires</span><span class=\"mtk7\">=</span><span class=\"mtk1\">sentry</span><span class=\"mtk7\">-</span><span class=\"mtk1\">cron.service</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">Requires</span><span class=\"mtk7\">=</span><span class=\"mtk1\">sentry</span><span class=\"mtk7\">-</span><span class=\"mtk1\">worker.service</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">[</span><span class=\"mtk9 mtki\">Service</span><span class=\"mtk1\">]</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">Type</span><span class=\"mtk7\">=</span><span class=\"mtk1\">simple</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">User</span><span class=\"mtk7\">=</span><span class=\"mtk1\">sentry</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">Group</span><span class=\"mtk7\">=</span><span class=\"mtk1\">sentry</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">WorkingDirectory</span><span class=\"mtk7\">=/</span><span class=\"mtk1\">home</span><span class=\"mtk7\">/</span><span class=\"mtk1\">sentry</span><span class=\"mtk7\">/</span><span class=\"mtk1\">.venv</span><span class=\"mtk7\">/</span><span class=\"mtk1\">sentry</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">Environment</span><span class=\"mtk7\">=</span><span class=\"mtk1\">SENTRY_CONF</span><span class=\"mtk7\">=/</span><span class=\"mtk1\">home</span><span class=\"mtk7\">/</span><span class=\"mtk1\">sentry</span><span class=\"mtk7\">/</span><span class=\"mtk1\">.sentry</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">ExecStart</span><span class=\"mtk7\">=/</span><span class=\"mtk1\">home</span><span class=\"mtk7\">/</span><span class=\"mtk1\">sentry</span><span class=\"mtk7\">/</span><span class=\"mtk1\">.venv</span><span class=\"mtk7\">/</span><span class=\"mtk1\">sentry</span><span class=\"mtk7\">/</span><span class=\"mtk1\">bin</span><span class=\"mtk7\">/</span><span class=\"mtk1\">sentry run web</span></span></span></code></pre>\n<pre class=\"grvsc-container monokai\" data-language=\"ps\" data-index=\"22\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk3\"># sentry-worker.service</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">[</span><span class=\"mtk9 mtki\">Unit</span><span class=\"mtk1\">]</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">Description</span><span class=\"mtk7\">=</span><span class=\"mtk1\">Sentry Worker Service</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">After</span><span class=\"mtk7\">=</span><span class=\"mtk1\">network.target</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">[</span><span class=\"mtk9 mtki\">Service</span><span class=\"mtk1\">]</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">Type</span><span class=\"mtk7\">=</span><span class=\"mtk1\">simple</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">User</span><span class=\"mtk7\">=</span><span class=\"mtk1\">sentry</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">Group</span><span class=\"mtk7\">=</span><span class=\"mtk1\">sentry</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">WorkingDirectory</span><span class=\"mtk7\">=/</span><span class=\"mtk1\">home</span><span class=\"mtk7\">/</span><span class=\"mtk1\">sentry</span><span class=\"mtk7\">/</span><span class=\"mtk1\">.venv</span><span class=\"mtk7\">/</span><span class=\"mtk1\">sentry</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">Environment</span><span class=\"mtk7\">=</span><span class=\"mtk1\">SENTRY_CONF</span><span class=\"mtk7\">=/</span><span class=\"mtk1\">home</span><span class=\"mtk7\">/</span><span class=\"mtk1\">sentry</span><span class=\"mtk7\">/</span><span class=\"mtk1\">.sentry</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">ExecStart</span><span class=\"mtk7\">=/</span><span class=\"mtk1\">home</span><span class=\"mtk7\">/</span><span class=\"mtk1\">sentry</span><span class=\"mtk7\">/</span><span class=\"mtk1\">.venv</span><span class=\"mtk7\">/</span><span class=\"mtk1\">sentry</span><span class=\"mtk7\">/</span><span class=\"mtk1\">bin</span><span class=\"mtk7\">/</span><span class=\"mtk1\">sentry run worker</span></span></span></code></pre>\n<pre class=\"grvsc-container monokai\" data-language=\"ps\" data-index=\"23\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk3\"># sentry-cron.service</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">[</span><span class=\"mtk9 mtki\">Unit</span><span class=\"mtk1\">]</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">Description</span><span class=\"mtk7\">=</span><span class=\"mtk1\">Sentry Cron Service</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">After</span><span class=\"mtk7\">=</span><span class=\"mtk1\">network.target</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">[</span><span class=\"mtk9 mtki\">Service</span><span class=\"mtk1\">]</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">Type</span><span class=\"mtk7\">=</span><span class=\"mtk1\">simple</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">User</span><span class=\"mtk7\">=</span><span class=\"mtk1\">sentry</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">Group</span><span class=\"mtk7\">=</span><span class=\"mtk1\">sentry</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">WorkingDirectory</span><span class=\"mtk7\">=/</span><span class=\"mtk1\">home</span><span class=\"mtk7\">/</span><span class=\"mtk1\">sentry</span><span class=\"mtk7\">/</span><span class=\"mtk1\">.venv</span><span class=\"mtk7\">/</span><span class=\"mtk1\">sentry</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">Environment</span><span class=\"mtk7\">=</span><span class=\"mtk1\">SENTRY_CONF</span><span class=\"mtk7\">=/</span><span class=\"mtk1\">home</span><span class=\"mtk7\">/</span><span class=\"mtk1\">sentry</span><span class=\"mtk7\">/</span><span class=\"mtk1\">.sentry</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">ExecStart</span><span class=\"mtk7\">=/</span><span class=\"mtk1\">home</span><span class=\"mtk7\">/</span><span class=\"mtk1\">sentry</span><span class=\"mtk7\">/</span><span class=\"mtk1\">.venv</span><span class=\"mtk7\">/</span><span class=\"mtk1\">sentry</span><span class=\"mtk7\">/</span><span class=\"mtk1\">bin</span><span class=\"mtk7\">/</span><span class=\"mtk1\">sentry run cron</span></span></span></code></pre>\n<p>위와같이 파일에 내용을 등록한 후 아래의 명령어를 수행하여 service를 수행시킨다.</p>\n<pre class=\"grvsc-container monokai\" data-language=\"ps\" data-index=\"24\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk3\"># systemctl 재호출</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">$ sudo systemctl daemon</span><span class=\"mtk7\">-</span><span class=\"mtk1\">reload</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk3\"># 추가한 sentry service들 등록</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">$ sudo systemctl enable sentry</span><span class=\"mtk7\">-</span><span class=\"mtk1\">web</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">$ sudo systemctl enable sentry</span><span class=\"mtk7\">-</span><span class=\"mtk1\">worker</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">$ sudo systemctl enable sentry</span><span class=\"mtk7\">-</span><span class=\"mtk1\">cron</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk3\"># 추가한 sentry service들 시작</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">$ sudo systemctl start sentry</span><span class=\"mtk7\">-</span><span class=\"mtk1\">worker</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">$ sudo systemctl start sentry</span><span class=\"mtk7\">-</span><span class=\"mtk1\">cron</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-source\"><span class=\"mtk1\">$ sudo systemctl start sentry</span><span class=\"mtk7\">-</span><span class=\"mtk1\">web</span></span></span></code></pre>\n<p>위의 service 방법을 제외하고 다른 부분은 다른점이 없다.</p>\n<blockquote>\n<p>내용에 틀린점이 있거나, 수정할 부분이 있다면 댓글로 피드백 부탁드립니다.</p>\n</blockquote>\n<style class=\"grvsc-styles\">\n  .grvsc-container {\n    overflow: auto;\n    position: relative;\n    -webkit-overflow-scrolling: touch;\n    padding-top: 1rem;\n    padding-top: var(--grvsc-padding-top, var(--grvsc-padding-v, 1rem));\n    padding-bottom: 1rem;\n    padding-bottom: var(--grvsc-padding-bottom, var(--grvsc-padding-v, 1rem));\n    border-radius: 8px;\n    border-radius: var(--grvsc-border-radius, 8px);\n    font-feature-settings: normal;\n    line-height: 1.4;\n  }\n  \n  .grvsc-code {\n    display: table;\n  }\n  \n  .grvsc-line {\n    display: table-row;\n    box-sizing: border-box;\n    width: 100%;\n    position: relative;\n  }\n  \n  .grvsc-line > * {\n    position: relative;\n  }\n  \n  .grvsc-gutter-pad {\n    display: table-cell;\n    padding-left: 0.75rem;\n    padding-left: calc(var(--grvsc-padding-left, var(--grvsc-padding-h, 1.5rem)) / 2);\n  }\n  \n  .grvsc-gutter {\n    display: table-cell;\n    -webkit-user-select: none;\n    -moz-user-select: none;\n    user-select: none;\n  }\n  \n  .grvsc-gutter::before {\n    content: attr(data-content);\n  }\n  \n  .grvsc-source {\n    display: table-cell;\n    padding-left: 1.5rem;\n    padding-left: var(--grvsc-padding-left, var(--grvsc-padding-h, 1.5rem));\n    padding-right: 1.5rem;\n    padding-right: var(--grvsc-padding-right, var(--grvsc-padding-h, 1.5rem));\n  }\n  \n  .grvsc-source:empty::after {\n    content: ' ';\n    -webkit-user-select: none;\n    -moz-user-select: none;\n    user-select: none;\n  }\n  \n  .grvsc-gutter + .grvsc-source {\n    padding-left: 0.75rem;\n    padding-left: calc(var(--grvsc-padding-left, var(--grvsc-padding-h, 1.5rem)) / 2);\n  }\n  \n  /* Line transformer styles */\n  \n  .grvsc-has-line-highlighting > .grvsc-code > .grvsc-line::before {\n    content: ' ';\n    position: absolute;\n    width: 100%;\n  }\n  \n  .grvsc-line-diff-add::before {\n    background-color: var(--grvsc-line-diff-add-background-color, rgba(0, 255, 60, 0.2));\n  }\n  \n  .grvsc-line-diff-del::before {\n    background-color: var(--grvsc-line-diff-del-background-color, rgba(255, 0, 20, 0.2));\n  }\n  \n  .grvsc-line-number {\n    padding: 0 2px;\n    text-align: right;\n    opacity: 0.7;\n  }\n  \n  .monokai {\n    background-color: #272822;\n    color: #f8f8f2;\n  }\n  .monokai .mtki { font-style: italic; }\n  .monokai .mtk3 { color: #75715E; }\n  .monokai .mtk1 { color: #F8F8F2; }\n  .monokai .mtk7 { color: #F92672; }\n  .monokai .mtk4 { color: #AE81FF; }\n  .monokai .mtk6 { color: #E6DB74; }\n  .monokai .mtk9 { color: #66D9EF; }\n  .monokai .mtk5 { color: #A6E22E; }\n  .monokai .mtk10 { color: #FD971F; }\n  .monokai .grvsc-line-highlighted::before {\n    background-color: var(--grvsc-line-highlighted-background-color, rgba(255, 255, 255, 0.1));\n    box-shadow: inset var(--grvsc-line-highlighted-border-width, 4px) 0 0 0 var(--grvsc-line-highlighted-border-color, rgba(255, 255, 255, 0.5));\n  }\n</style>","tableOfContents":"<ul>\n<li>\n<p><a href=\"/posts/sentry_server_%EC%84%A4%EC%B9%98/#sentry-%EC%84%9C%EB%B2%84-%EC%84%A4%EC%B9%98\">Sentry 서버 설치</a></p>\n<ul>\n<li><a href=\"/posts/sentry_server_%EC%84%A4%EC%B9%98/#%EC%84%A4%EC%B9%98-%EC%A0%84-%EB%AA%A8%EB%93%88-%EB%B0%8F-%EC%84%9C%EB%B2%84-%EC%84%A4%EC%A0%95\">설치 전 모듈 및 서버 설정</a></li>\n<li>\n<p><a href=\"/posts/sentry_server_%EC%84%A4%EC%B9%98/#sentry-%EC%97%B0%EB%8F%99%EC%9D%84-%EC%9C%84%ED%95%9C-postgre-sql-%EC%84%A4%EC%B9%98-%EB%B0%8F-%EC%85%8B%ED%8C%85\">Sentry 연동을 위한 Postgre-SQL 설치 및 셋팅</a></p>\n<ul>\n<li><a href=\"/posts/sentry_server_%EC%84%A4%EC%B9%98/#postgre-sql-%EC%84%A4%EC%B9%98\">#Postgre-SQL 설치</a></li>\n<li><a href=\"/posts/sentry_server_%EC%84%A4%EC%B9%98/#postgre-sql-%EC%85%8B%ED%8C%85\">#Postgre-SQL 셋팅</a></li>\n<li>\n<p><a href=\"/posts/sentry_server_%EC%84%A4%EC%B9%98/#sentry-%EC%84%A4%EC%B9%98\">#Sentry 설치</a></p>\n<ul>\n<li><a href=\"/posts/sentry_server_%EC%84%A4%EC%B9%98/#1-python-%ED%99%98%EA%B2%BD%EC%84%A4%EC%A0%95-%EB%B0%8F-sentry-%EC%84%A4%EC%B9%98\">1. python 환경설정 및 sentry 설치</a></li>\n<li><a href=\"/posts/sentry_server_%EC%84%A4%EC%B9%98/#2-sentry-%EC%B4%88%EA%B8%B0-%ED%99%98%EA%B2%BD%EC%84%A4%EC%A0%95\">2. Sentry 초기 환경설정</a></li>\n<li><a href=\"/posts/sentry_server_%EC%84%A4%EC%B9%98/#3-sentry-%EC%84%9C%EB%B2%84-%EC%8B%A4%ED%96%89\">3. Sentry 서버 실행</a></li>\n<li><a href=\"/posts/sentry_server_%EC%84%A4%EC%B9%98/#4-daemon-%EC%8B%A4%ED%96%89\">4. Daemon 실행</a></li>\n</ul>\n</li>\n</ul>\n</li>\n<li><a href=\"/posts/sentry_server_%EC%84%A4%EC%B9%98/#sentry-upgrade-by-2020-09-13-%EB%82%B4%EC%9A%A9%EC%88%98%EC%A0%95\">Sentry Upgrade by 2020-09-13 내용수정</a></li>\n<li><a href=\"/posts/sentry_server_%EC%84%A4%EC%B9%98/#%EB%A9%94%EC%9D%BC-%EB%B0%9C%EC%86%A1-%EA%B8%B0%EB%8A%A5-%EC%B6%94%EA%B0%80-by-2020-09-13-%EB%82%B4%EC%9A%A9%EC%88%98%EC%A0%95\">메일 발송 기능 추가 by 2020-09-13 내용수정</a></li>\n<li><a href=\"/posts/sentry_server_%EC%84%A4%EC%B9%98/#ubuntu-16-%EC%9D%B4%EC%83%81-%EB%B2%84%EC%A0%84%EC%9D%98-systemd%EB%A5%BC-%EC%9D%B4%EC%9A%A9%ED%95%9C-deamon-%EC%8B%A4%ED%96%89-by-2020-09-13-%EB%82%B4%EC%9A%A9%EC%B6%94%EA%B0%80\">Ubuntu 16 이상 버전의 systemd를 이용한 deamon 실행 by 2020-09-13 내용추가</a></li>\n</ul>\n</li>\n</ul>","fields":{"slug":"/posts/sentry_server_설치/","tagSlugs":["/tag/sentry/","/tag/python/"]},"frontmatter":{"date":"2019-11-11 19:27:46.081432","description":"Error tracking과 Log 관리등을 원격으로 관리할 수 있게 해주는 모니터링 서비스 Sentry를 직접 설치 및 운영한다.","tags":["Sentry","python"],"title":"Sentry server 설치(20.09.13 수정)","socialImage":null},"headings":[{"value":"Sentry 서버 설치","depth":1},{"value":"설치 전 모듈 및 서버 설정","depth":2},{"value":"Sentry 연동을 위한 Postgre-SQL 설치 및 셋팅","depth":2},{"value":"#Postgre-SQL 설치","depth":3},{"value":"#Postgre-SQL 셋팅","depth":3},{"value":"#Sentry 설치","depth":3},{"value":"1. python 환경설정 및 sentry 설치","depth":4},{"value":"2. Sentry 초기 환경설정","depth":4},{"value":"3. Sentry 서버 실행","depth":4},{"value":"4. Daemon 실행","depth":4},{"value":"Sentry Upgrade by 2020-09-13 내용수정","depth":2},{"value":"메일 발송 기능 추가 by 2020-09-13 내용수정","depth":2},{"value":"Ubuntu 16 이상 버전의 systemd를 이용한 deamon 실행 by 2020-09-13 내용추가","depth":2}]}},"pageContext":{"slug":"/posts/sentry_server_설치/"}}}