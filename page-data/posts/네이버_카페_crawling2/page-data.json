{"componentChunkName":"component---src-templates-post-template-js","path":"/posts/네이버_카페_crawling2/","result":{"data":{"markdownRemark":{"id":"d2820838-6da6-53d6-a240-f11a2d435ca4","html":"<blockquote>\n<p>이전글 보기 <a href=\"/posts/%EB%84%A4%EC%9D%B4%EB%B2%84_%EC%B9%B4%ED%8E%98_crawling1\">네이버 카페 Crawling 1: cafe 인증</a></p>\n</blockquote>\n<p>이전 글에서 pyppetter를 이용해서 카페 인증 및 화면 이동까지 설명했었다. 여기서는 카페에서 글 목록을 가져오고, 해당 글에서 내용(이미지)를 가져오는 부분을 다루도록 한다.</p>\n<p>필자의 경우 자녀의 카페 사진을 가져오기 위해서 해당 프로그램을 만들었기에 글 목록과 글의 이미지 정도의 내용 만으로도 충분하지만, 더 많은 정보를 가져오고 싶다면 여기서 다루는 내용을 응용하여 충분히 원하는 정보를 추출 할 수 있다고 본다.</p>\n<h2 id=\"step-1-카페-게시글-화면-이동\" style=\"position:relative;\"><a href=\"#step-1-%EC%B9%B4%ED%8E%98-%EA%B2%8C%EC%8B%9C%EA%B8%80-%ED%99%94%EB%A9%B4-%EC%9D%B4%EB%8F%99\" aria-label=\"step 1 카페 게시글 화면 이동 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Step 1: 카페 게시글 화면 이동</h2>\n<blockquote>\n<p>💡해당 글에서 설명하는 코드에 있는 xpath의 위치 및 selector 경로는 모두 chrome의 개발자 도구를 통해서 확인 하고 찾은 값이다. 추후에 경로가 달라진다면 개발자 도구 등을 이용하여 위치를 찾으면 된다.</p>\n</blockquote>\n<p>전의 글에 이어서 인증을 하였다면, 이제 원하는 카페의 글들을 가져오기 위해서 해당 카페의 페이지로 이동을 하여야 한다.</p>\n<pre class=\"grvsc-container monokai\" data-language=\"python\" data-index=\"0\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"1\"></span><span class=\"grvsc-source\"><span class=\"mtk3\"># 페이지 이동</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"2\"></span><span class=\"grvsc-source\"><span class=\"mtk3\">## cafe_url에는 본인이 이동하고자 하는 url 주소를 입력하면 된다.</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"3\"></span><span class=\"grvsc-source\"><span class=\"mtk7\">await</span><span class=\"mtk1\"> page.goto(cafe_url)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"4\"></span><span class=\"grvsc-source\"><span class=\"mtk7\">await</span><span class=\"mtk1\"> page.waitFor(</span><span class=\"mtk4\">1000</span><span class=\"mtk1\">)</span></span></span></code></pre>\n<p>위의 코드로 원하는 카페의 페이지로 이동이 가능하다. 잘 모르겠다면 이전 글을 참조하자.</p>\n<h2 id=\"step-2-카페-게시글의-이미지-가져오기\" style=\"position:relative;\"><a href=\"#step-2-%EC%B9%B4%ED%8E%98-%EA%B2%8C%EC%8B%9C%EA%B8%80%EC%9D%98-%EC%9D%B4%EB%AF%B8%EC%A7%80-%EA%B0%80%EC%A0%B8%EC%98%A4%EA%B8%B0\" aria-label=\"step 2 카페 게시글의 이미지 가져오기 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Step 2: 카페 게시글의 이미지 가져오기</h2>\n<p>카페의 이미지를 가져오기 위해서는 내가 원하는 글이 있는 링크를 위해서 표현한대로 <code>page.goto(게시글 URL)</code>방식을 통해서 이동하면 된다.\n<code>page</code> 객체에 현재 내가 접근한 page의 정보들이 모두 들어있기에 위에서 이동한 <code>page</code> 객체를 이용해야 한다.</p>\n<p>네이버 카페는 사이드의 목록정보와 본문글이 frame으로 각기 나뉘어 있기에 본문이 있는 frame에 접근한 후에글의 내용을 가져와야 한다.</p>\n<pre class=\"grvsc-container monokai\" data-language=\"python\" data-index=\"1\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"1\"></span><span class=\"grvsc-source\"><span class=\"mtk3\"># 카페 메인 프레임 선택</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"2\"></span><span class=\"grvsc-source\"><span class=\"mtk3\">## pyppeteet를 이용하여 elems을 가져올때는 return 되는 type은 기본적으로 list(array) 형태를 띈다.</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"3\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">main_frame </span><span class=\"mtk7\">=</span><span class=\"mtk1\"> [frame </span><span class=\"mtk7\">for</span><span class=\"mtk1\"> frame </span><span class=\"mtk7\">in</span><span class=\"mtk1\"> page.frames </span><span class=\"mtk7\">if</span><span class=\"mtk1\"> frame.name </span><span class=\"mtk7\">==</span><span class=\"mtk1\"> </span><span class=\"mtk6\">&#39;cafe_main&#39;</span><span class=\"mtk1\">][</span><span class=\"mtk4\">0</span><span class=\"mtk1\">]</span></span></span></code></pre>\n<p>위의 형태로 본문이 있는 main frame에 접근하여서 <code>main_frame</code> 객체에게서 글의 내용 제목등을 가져올 수 있다.</p>\n<p>아래의 코드를 참조하자.</p>\n<pre class=\"grvsc-container monokai\" data-language=\"python\" data-index=\"2\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"1\"></span><span class=\"grvsc-source\"><span class=\"mtk6\">&#39;&#39;&#39;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"2\"></span><span class=\"grvsc-source\"><span class=\"mtk6\">main-frame에서 xpath 상으로 class명이 tit-box인 element 목록을 추출한다.</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"3\"></span><span class=\"grvsc-source\"><span class=\"mtk6\">해당 class elem에 글의 제목 및 title에 위치하는 관련정보들이 존재한다.&#39;&#39;&#39;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"4\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">elem_title_box </span><span class=\"mtk7\">=</span><span class=\"mtk1\"> </span><span class=\"mtk7\">await</span><span class=\"mtk1\"> main_frame.xpath(</span><span class=\"mtk6\">&#39;//*[@class=&quot;tit-box&quot;]&#39;</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"5\"></span><span class=\"grvsc-source\"><span class=\"mtk3\"># 위의 목록에서 실제 element를 가져온다.(xpath 등과 같이 element 정보를 가져오면 모두 list형태를 띈다)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"6\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">title_box </span><span class=\"mtk7\">=</span><span class=\"mtk1\"> elem_title_box[</span><span class=\"mtk4\">0</span><span class=\"mtk1\">]</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"7\"></span><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"8\"></span><span class=\"grvsc-source\"><span class=\"mtk3\"># 해당 query에 만족하는 elem의 Text를 가져온다.(여기선 게시글의 제목)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"9\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">article_title </span><span class=\"mtk7\">=</span><span class=\"mtk1\"> </span><span class=\"mtk7\">await</span><span class=\"mtk1\"> title_box.Jeval(</span><span class=\"mtk6\">&#39;div.fl tbody span.b.m-tcol-c&#39;</span><span class=\"mtk1\">, </span><span class=\"mtk6\">&#39;node =&gt; node.innerText&#39;</span><span class=\"mtk1\">)</span></span></span></code></pre>\n<p>여기서 위의 코드를 보면 <code>Jeval</code> method가 존재한다. 이는 기존에 <code>document.querySelector</code> 와 같은 기능을 하는데, 다른점은 해당 기능을 수행 후 <code>eval</code> 기능을 수행한다.</p>\n<blockquote>\n<p>💡Pyppetter문서에서는 <code>Jeval</code> 에 대해서 아래와 같이 설명합니다.\n<code>Jeval(selector: str, pageFunction: str, *args) → Any</code>\nalias to querySelectorAllEval()</p>\n</blockquote>\n<p>위의 코드에서 게시글의 제목을 가져오는건 필자가 목적했던 바의 부수적인 부분이다, 필자의 주 목적인 이미지들을 가져오는 기능이 필요하다.</p>\n<pre class=\"grvsc-container monokai\" data-language=\"python\" data-index=\"3\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"1\"></span><span class=\"grvsc-source\"><span class=\"mtk3\"># main_frame 객체에서 게시글의 본문내용을 가지고 있는 tbody라는 id를 가진 elem을 가져옵니다.</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"2\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">elem_body </span><span class=\"mtk7\">=</span><span class=\"mtk1\"> </span><span class=\"mtk7\">await</span><span class=\"mtk1\"> main_frame.xpath(</span><span class=\"mtk6\">&#39;//*[@id=&quot;tbody&quot;]&#39;</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"3\"></span><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"4\"></span><span class=\"grvsc-source\"><span class=\"mtk3\"># 해당 tbody안에 속한 모든 image elem을 가져와서 주소와 id 객체를 가지는 list 형태로 return 합니다.</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"5\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">article_imgs </span><span class=\"mtk7\">=</span><span class=\"mtk1\"> </span><span class=\"mtk7\">await</span><span class=\"mtk1\"> elem_body.JJeval(</span><span class=\"mtk6\">&#39;img&#39;</span><span class=\"mtk1\">, </span><span class=\"mtk6\">&#39;(nodes) =&gt; nodes.map(n =&gt; { return { src: n.src, name: n.id }})&#39;</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"6\"></span><span class=\"grvsc-source\"><span class=\"mtk7\">await</span><span class=\"mtk1\"> page.waitFor(</span><span class=\"mtk4\">1000</span><span class=\"mtk1\">)</span></span></span></code></pre>\n<p>위의 코드를 통해서 tbody안에 있는 모든 img elem 들의 src 주소와 id 정보를 가져올 수 있다. 위의 코드에는 아까 <code>Jeval</code> 과 비슷한 <code>JJeval</code> method가 보이는데 차이는 <code>Jeval</code> 이 찾아진 여러개의 elem들 중에서 첫번째의 elem만 가져온다면, <code>JJeval</code>은 모든 elem들을 가져온다는 것이다.</p>\n<blockquote>\n<p>💡Pypetter 문서에서는 <code>JJeval</code>에 대해서 아래와 같이 설명합니다.\n<code>JJeval(selector: str, pageFunction: str, *args) → Optional[Dict[KT, VT]]</code></p>\n</blockquote>\n<p>여기까지만 읽어보았어도 위의 코드들을 응용하여 게시글의 원하는 내용들을 Crawling 하는데 문제가 없다고 생각한다.</p>\n<p>다만, 필자의 경우 게시글 하나가 아닌 여러개의 글을 가져와야 했기에 게시글 목록을 가져오는 내용까지 같이 설명하기로 한다.</p>\n<h2 id=\"step-3-카페-게시글-목록-가져오기\" style=\"position:relative;\"><a href=\"#step-3-%EC%B9%B4%ED%8E%98-%EA%B2%8C%EC%8B%9C%EA%B8%80-%EB%AA%A9%EB%A1%9D-%EA%B0%80%EC%A0%B8%EC%98%A4%EA%B8%B0\" aria-label=\"step 3 카페 게시글 목록 가져오기 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Step 3: 카페 게시글 목록 가져오기</h2>\n<p>카페 게시글 목록 페이지에 접근해서 해당 글들을 가져오면 되는데 한가지 문제가 있다.</p>\n<p>아래의 이미지는 카페 게시글 목록의 상단에 위치한 elem을 캡쳐한 모습인데, 각 카페 게시글마다 운영진의 설정에 따라서 기본 셋팅이 다르다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 788px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/a367959a9c38de065b254366e06cfd4a/ea7fb/0419_1.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 13.333333333333334%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAYAAACTWi8uAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAiElEQVQI11WPXQoDIQyEvf9N+t477FsP0BYUCkIRV7t9sP4kU2PZxQofE2ImTBT6Y+ZBa+2AiORrqLDPUCMUqqj8m8k5o5QyavEpMUmRUoLWGsaYoTHGsdA5B+89Qgh4vTesjydObsE5XLoRuN5vsNYeO9SccE/zl2jqEfd+10QFnw4To04XCV/uWumOrGwfpgAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/a367959a9c38de065b254366e06cfd4a/8ac56/0419_1.webp 240w,\n/static/a367959a9c38de065b254366e06cfd4a/d3be9/0419_1.webp 480w,\n/static/a367959a9c38de065b254366e06cfd4a/4d911/0419_1.webp 788w\"\n              sizes=\"(max-width: 788px) 100vw, 788px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/a367959a9c38de065b254366e06cfd4a/8ff5a/0419_1.png 240w,\n/static/a367959a9c38de065b254366e06cfd4a/e85cb/0419_1.png 480w,\n/static/a367959a9c38de065b254366e06cfd4a/ea7fb/0419_1.png 788w\"\n            sizes=\"(max-width: 788px) 100vw, 788px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/a367959a9c38de065b254366e06cfd4a/ea7fb/0419_1.png\"\n            alt=\"0419 1\"\n            title=\"0419 1\"\n            loading=\"lazy\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<p>네이버 카페의 게시판은 위의 이미지와 같이 카드, 영상, 앨범, 리스트 등의 형태로 볼 수 있게 되어있고 카페별로 기본 형태가 달라서 가져오기 편하고 한화면에 최대한 많은 글들이 보일 수 있도록 변경해줘야 다음작업을 수행하기에 편하다. 카페의 글을 가져오기 전에 선행작업을 통해서 카페글을 최대한 많이 가져올 수 있는 형태로 바꾸자, 먼저 목록 스타일부터 변경해준다.</p>\n<pre class=\"grvsc-container monokai\" data-language=\"python\" data-index=\"4\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"1\"></span><span class=\"grvsc-source\"><span class=\"mtk3\"># 글 목록이 존재하는 cafe_main frame을 가져옵니다.</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"2\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">main_frame </span><span class=\"mtk7\">=</span><span class=\"mtk1\"> [frame </span><span class=\"mtk7\">for</span><span class=\"mtk1\"> frame </span><span class=\"mtk7\">in</span><span class=\"mtk1\"> page.frames </span><span class=\"mtk7\">if</span><span class=\"mtk1\"> frame.name </span><span class=\"mtk7\">==</span><span class=\"mtk1\"> </span><span class=\"mtk6\">&#39;cafe_main&#39;</span><span class=\"mtk1\">][</span><span class=\"mtk4\">0</span><span class=\"mtk1\">]</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"3\"></span><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"4\"></span><span class=\"grvsc-source\"><span class=\"mtk3\"># 해당 frame에서 위의 목록 스타일 정보를 가지는 elem을 가져옵니다.</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"5\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">elem_list_style </span><span class=\"mtk7\">=</span><span class=\"mtk1\"> </span><span class=\"mtk7\">await</span><span class=\"mtk1\"> main_frame.xpath(</span><span class=\"mtk6\">&#39;//*[@id=&quot;main-area&quot;]/div[@class=&quot;list-style&quot;]&#39;</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"6\"></span><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"7\"></span><span class=\"grvsc-source\"><span class=\"mtk3\"># 우리는 List 스타일을 원하니 list elem객체를 가져와서 click 합니다.</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"8\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">elem_btn_sort_list </span><span class=\"mtk7\">=</span><span class=\"mtk1\"> </span><span class=\"mtk7\">await</span><span class=\"mtk1\"> elem_list_style[</span><span class=\"mtk4\">0</span><span class=\"mtk1\">].J(</span><span class=\"mtk6\">&#39;.sort_area .sort_form .sort_list&#39;</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"9\"></span><span class=\"grvsc-source\"><span class=\"mtk7\">await</span><span class=\"mtk1\"> elem_btn_sort_list.click()</span><span class=\"mtk8\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"10\"></span><span class=\"grvsc-source\"><span class=\"mtk7\">await</span><span class=\"mtk1\"> page.waitFor(</span><span class=\"mtk4\">1500</span><span class=\"mtk1\">)</span></span></span></code></pre>\n<p>여기서 위의 코드를 보면 <code>J</code> method가 존재하는데, 이는 <code>document.querySelector</code> 와 같은 기능을 한다.</p>\n<p>목록 스타일을 List 형태로 바꾸었으면, 게시물이 가장 많이 나오는 갯수로 변경을 한다.</p>\n<pre class=\"grvsc-container monokai\" data-language=\"python\" data-index=\"5\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"1\"></span><span class=\"grvsc-source\"><span class=\"mtk3\"># 목록의 출력 갯수를 표시하는 elem을 선택합니다.</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"2\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">elem_page_size </span><span class=\"mtk7\">=</span><span class=\"mtk1\"> </span><span class=\"mtk7\">await</span><span class=\"mtk1\"> main_frame.xpath(</span><span class=\"mtk6\">&#39;//*[@id=&quot;listSizeSelectDiv&quot;]/a&#39;</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"3\"></span><span class=\"grvsc-source\"><span class=\"mtk7\">await</span><span class=\"mtk1\"> elem_page_size[</span><span class=\"mtk4\">0</span><span class=\"mtk1\">].click()</span><span class=\"mtk8\">;</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"4\"></span><span class=\"grvsc-source\"><span class=\"mtk7\">await</span><span class=\"mtk1\"> page.waitFor(</span><span class=\"mtk4\">1000</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"5\"></span><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"6\"></span><span class=\"grvsc-source\"><span class=\"mtk3\"># 카페의 목록형식에서 50개씩 나오기 선택</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"7\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">elem_50_page </span><span class=\"mtk7\">=</span><span class=\"mtk1\"> </span><span class=\"mtk7\">await</span><span class=\"mtk1\"> main_frame.xpath(</span><span class=\"mtk6\">&#39;//*[@id=&quot;listSizeSelectDiv&quot;]/ul/li[7]/a&#39;</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"8\"></span><span class=\"grvsc-source\"><span class=\"mtk7\">await</span><span class=\"mtk1\"> elem_50_page[</span><span class=\"mtk4\">0</span><span class=\"mtk1\">].click()</span><span class=\"mtk8\">;</span></span></span></code></pre>\n<p>위의 작업까지 했다면 이제 게시물 출력 스타일이 리스트 형태에 게시글을 50개씩 보인다.</p>\n<p>이제 여기서 게시글의 목록을 가져와서 해당 게시글들의 URL 주소를 가져온다.</p>\n<pre class=\"grvsc-container monokai\" data-language=\"python\" data-index=\"6\"><code class=\"grvsc-code\"><span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"1\"></span><span class=\"grvsc-source\"><span class=\"mtk3\"># 페이지의 목록들 가져오기</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"2\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">elem_trs </span><span class=\"mtk7\">=</span><span class=\"mtk1\"> </span><span class=\"mtk7\">await</span><span class=\"mtk1\"> main_frame.xpath(</span><span class=\"mtk6\">&#39;//*[@id=&quot;main-area&quot;]/div[@class=&quot;article-board m-tcol-c&quot;]/table/tbody/tr&#39;</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"3\"></span><span class=\"grvsc-source\"><span class=\"mtk7\">await</span><span class=\"mtk1\"> page.waitFor(</span><span class=\"mtk4\">1000</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"4\"></span><span class=\"grvsc-source\"></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"5\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">article_urls </span><span class=\"mtk7\">=</span><span class=\"mtk1\"> []</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"6\"></span><span class=\"grvsc-source\"><span class=\"mtk7\">for</span><span class=\"mtk1\"> idx, tr </span><span class=\"mtk7\">in</span><span class=\"mtk1\"> </span><span class=\"mtk9\">enumerate</span><span class=\"mtk1\">(elem_trs):</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"7\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">  tr_article </span><span class=\"mtk7\">=</span><span class=\"mtk1\"> </span><span class=\"mtk7\">await</span><span class=\"mtk1\"> tr.Jeval(</span><span class=\"mtk6\">&#39;.td_article .board-list .article&#39;</span><span class=\"mtk1\">,</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"8\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">                        </span><span class=\"mtk6\">&#39;node =&gt; { return { href: node.href, title: node.innerText } }&#39;</span><span class=\"mtk1\">)</span></span></span>\n<span class=\"grvsc-line\"><span class=\"grvsc-gutter-pad\"></span><span class=\"grvsc-gutter grvsc-line-number\" aria-hidden=\"true\" data-content=\"9\"></span><span class=\"grvsc-source\"><span class=\"mtk1\">  article_urls.append(tr_article.get(</span><span class=\"mtk6\">&#39;href&#39;</span><span class=\"mtk1\">))</span></span></span></code></pre>\n<p>위에서 나오 코드들을 응용하면, 더 다양한 정보의 추출이 가능하고, 위에서 Crawling한 내용들을 DB와 파일형태로 관리한다면 주기적으로 원하는 정보를 수집할 수 있는 자동화 서비스를 만들기에도 수월하다고 생각한다.</p>\n<blockquote>\n<p>📌내용이 잘못됬거나 변경된 사항이 있다면 코멘트 바랍니다.</p>\n</blockquote>\n<style class=\"grvsc-styles\">\n  .grvsc-container {\n    overflow: auto;\n    position: relative;\n    -webkit-overflow-scrolling: touch;\n    padding-top: 1rem;\n    padding-top: var(--grvsc-padding-top, var(--grvsc-padding-v, 1rem));\n    padding-bottom: 1rem;\n    padding-bottom: var(--grvsc-padding-bottom, var(--grvsc-padding-v, 1rem));\n    border-radius: 8px;\n    border-radius: var(--grvsc-border-radius, 8px);\n    font-feature-settings: normal;\n    line-height: 1.4;\n  }\n  \n  .grvsc-code {\n    display: table;\n  }\n  \n  .grvsc-line {\n    display: table-row;\n    box-sizing: border-box;\n    width: 100%;\n    position: relative;\n  }\n  \n  .grvsc-line > * {\n    position: relative;\n  }\n  \n  .grvsc-gutter-pad {\n    display: table-cell;\n    padding-left: 0.75rem;\n    padding-left: calc(var(--grvsc-padding-left, var(--grvsc-padding-h, 1.5rem)) / 2);\n  }\n  \n  .grvsc-gutter {\n    display: table-cell;\n    -webkit-user-select: none;\n    -moz-user-select: none;\n    user-select: none;\n  }\n  \n  .grvsc-gutter::before {\n    content: attr(data-content);\n  }\n  \n  .grvsc-source {\n    display: table-cell;\n    padding-left: 1.5rem;\n    padding-left: var(--grvsc-padding-left, var(--grvsc-padding-h, 1.5rem));\n    padding-right: 1.5rem;\n    padding-right: var(--grvsc-padding-right, var(--grvsc-padding-h, 1.5rem));\n  }\n  \n  .grvsc-source:empty::after {\n    content: ' ';\n    -webkit-user-select: none;\n    -moz-user-select: none;\n    user-select: none;\n  }\n  \n  .grvsc-gutter + .grvsc-source {\n    padding-left: 0.75rem;\n    padding-left: calc(var(--grvsc-padding-left, var(--grvsc-padding-h, 1.5rem)) / 2);\n  }\n  \n  /* Line transformer styles */\n  \n  .grvsc-has-line-highlighting > .grvsc-code > .grvsc-line::before {\n    content: ' ';\n    position: absolute;\n    width: 100%;\n  }\n  \n  .grvsc-line-diff-add::before {\n    background-color: var(--grvsc-line-diff-add-background-color, rgba(0, 255, 60, 0.2));\n  }\n  \n  .grvsc-line-diff-del::before {\n    background-color: var(--grvsc-line-diff-del-background-color, rgba(255, 0, 20, 0.2));\n  }\n  \n  .grvsc-line-number {\n    padding: 0 2px;\n    text-align: right;\n    opacity: 0.7;\n  }\n  \n  .monokai {\n    background-color: #272822;\n    color: #f8f8f2;\n  }\n  .monokai .mtk3 { color: #75715E; }\n  .monokai .mtk7 { color: #F92672; }\n  .monokai .mtk1 { color: #F8F8F2; }\n  .monokai .mtk4 { color: #AE81FF; }\n  .monokai .mtk6 { color: #E6DB74; }\n  .monokai .mtk8 { color: #F8F8F0; }\n  .monokai .mtk9 { color: #66D9EF; }\n  .monokai .grvsc-line-highlighted::before {\n    background-color: var(--grvsc-line-highlighted-background-color, rgba(255, 255, 255, 0.1));\n    box-shadow: inset var(--grvsc-line-highlighted-border-width, 4px) 0 0 0 var(--grvsc-line-highlighted-border-color, rgba(255, 255, 255, 0.5));\n  }\n</style>","tableOfContents":"<ul>\n<li><a href=\"/posts/%EB%84%A4%EC%9D%B4%EB%B2%84_%EC%B9%B4%ED%8E%98_crawling2/#step-1-%EC%B9%B4%ED%8E%98-%EA%B2%8C%EC%8B%9C%EA%B8%80-%ED%99%94%EB%A9%B4-%EC%9D%B4%EB%8F%99\">Step 1: 카페 게시글 화면 이동</a></li>\n<li><a href=\"/posts/%EB%84%A4%EC%9D%B4%EB%B2%84_%EC%B9%B4%ED%8E%98_crawling2/#step-2-%EC%B9%B4%ED%8E%98-%EA%B2%8C%EC%8B%9C%EA%B8%80%EC%9D%98-%EC%9D%B4%EB%AF%B8%EC%A7%80-%EA%B0%80%EC%A0%B8%EC%98%A4%EA%B8%B0\">Step 2: 카페 게시글의 이미지 가져오기</a></li>\n<li><a href=\"/posts/%EB%84%A4%EC%9D%B4%EB%B2%84_%EC%B9%B4%ED%8E%98_crawling2/#step-3-%EC%B9%B4%ED%8E%98-%EA%B2%8C%EC%8B%9C%EA%B8%80-%EB%AA%A9%EB%A1%9D-%EA%B0%80%EC%A0%B8%EC%98%A4%EA%B8%B0\">Step 3: 카페 게시글 목록 가져오기</a></li>\n</ul>","fields":{"slug":"/posts/네이버_카페_crawling2/","tagSlugs":["/tag/python-3/","/tag/pyppeteer/","/tag/naver-cafe/","/tag/crawling/","/tag/네이버-카페/","/tag/크롤링/"]},"frontmatter":{"date":"2020-04-19 01:45:24.995529","description":"개발자 아빠가 아이의 사진을 관리하는 법","tags":["python3","pyppeteer","naver cafe","crawling","네이버 카페","크롤링"],"title":"네이버 카페 Crawling 2: cafe글 가져오기","socialImage":null},"headings":[{"value":"Step 1: 카페 게시글 화면 이동","depth":2},{"value":"Step 2: 카페 게시글의 이미지 가져오기","depth":2},{"value":"Step 3: 카페 게시글 목록 가져오기","depth":2}]}},"pageContext":{"slug":"/posts/네이버_카페_crawling2/"}},"staticQueryHashes":["251939775","3691206191","401334301"]}